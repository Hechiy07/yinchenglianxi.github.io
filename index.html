<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹ç†éŸ³ç¨‹ç»ƒä¹ </title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .description {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        /* é€‰é¡¹å¡æ ·å¼ */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .tab-btn {
            flex: 1;
            padding: 18px 20px;
            background-color: #ecf0f1;
            border: none;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .tab-btn.active {
            background-color: #3498db;
            color: white;
        }
        
        .tab-btn:hover:not(.active) {
            background-color: #d5dbdb;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* å­¦ä¹ æ¿å—æ ·å¼ */
        .learning-panel {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .section-title {
            color: #3498db;
            margin-top: 30px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        .section-title:first-child {
            margin-top: 0;
        }
        
        .learning-content {
            line-height: 1.8;
            font-size: 1.1em;
        }
        
        .definition-box {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2ecc71;
        }
        
        .definition-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .interval-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .interval-table th, .interval-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .interval-table th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        
        .interval-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .interval-table tr:hover {
            background-color: #f1f8ff;
        }
        
        .interval-table td:first-child {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .example-box {
            background-color: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
        
        .example-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .example-item {
            margin: 10px 0;
            padding: 8px 12px;
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .tip-box {
            background-color: #fff8e1;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #f39c12;
        }
        
        .tip-title {
            font-weight: bold;
            color: #d35400;
            margin-bottom: 10px;
        }
        
        /* ç»ƒä¹ æ¿å—æ ·å¼ */
        .practice-panel {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .control-panel, .exercise-panel, .result-panel {
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .result-panel {
            display: none;
        }
        
        .panel-title {
            font-size: 1.4em;
            color: #3498db;
            margin-top: 0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-group {
            margin-bottom: 25px;
        }
        
        .settings-title {
            font-weight: bold;
            margin-bottom: 12px;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .option-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }
        
        .option-item label {
            font-size: 1em;
            cursor: pointer;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .primary-btn {
            background-color: #3498db;
            color: white;
            flex-grow: 1;
        }
        
        .primary-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .secondary-btn {
            background-color: #2ecc71;
            color: white;
            flex-grow: 1;
        }
        
        .secondary-btn:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        
        .reset-btn {
            background-color: #e74c3c;
            color: white;
        }
        
        .reset-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }
        
        .exercise-content {
            text-align: center;
            padding: 20px 0;
        }
        
        /* é¢˜ç›®è¡¨ç°æ ·å¼ */
        .question-container {
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
        }
        
        .question-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .notes-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin-bottom: 25px;
        }
        
        .note-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .note-label {
            font-size: 1.1em;
            color: #7f8c8d;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .note-display {
            font-size: 3.5em;
            font-weight: bold;
            color: #2c3e50;
            min-height: 120px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .note-card {
            background: white;
            width: 160px;
            height: 160px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 3px solid;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .note-card.start {
            border-color: #2ecc71;
            background: linear-gradient(135deg, #f0f9f4 0%, #e1f5e9 100%);
        }
        
        .note-card.start::before {
            content: "èµ·å§‹éŸ³";
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 0.8em;
            color: #27ae60;
            font-weight: bold;
        }
        
        .note-card.end {
            border-color: #e74c3c;
            background: linear-gradient(135deg, #fef0f0 0%, #fce4e4 100%);
        }
        
        .note-card.end::before {
            content: "ç»“æŸéŸ³";
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 0.8em;
            color: #c0392b;
            font-weight: bold;
        }
        
        .note-symbol {
            font-size: 3em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .interval-arrow {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .arrow-symbol {
            font-size: 3em;
            color: #3498db;
            margin-bottom: 10px;
        }
        
        .arrow-text {
            font-size: 1.1em;
            color: #7f8c8d;
            font-weight: bold;
        }
        
        .interval-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }
        
        .interval-btn {
            padding: 16px 10px;
            background-color: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .interval-btn:hover {
            background-color: #e9ecef;
            border-color: #3498db;
        }
        
        .interval-btn.selected {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .result-content {
            text-align: center;
            padding: 10px 0;
        }
        
        .result-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        .correct .result-icon {
            color: #2ecc71;
        }
        
        .incorrect .result-icon {
            color: #e74c3c;
        }
        
        .result-text {
            font-size: 1.4em;
            margin-bottom: 15px;
        }
        
        .result-details {
            font-size: 1.2em;
            margin-bottom: 25px;
            color: #7f8c8d;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        /* é’¢ç´é”®ç›˜æ ·å¼ */
        .keyboard-container {
            margin: 30px 0;
            padding: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .keyboard {
            display: flex;
            position: relative;
            height: 180px;
            background-color: #f0f0f0;
            border-radius: 5px;
            padding: 10px;
            overflow: hidden;
        }
        
        .white-keys {
            display: flex;
            position: relative;
            z-index: 1;
            width: 100%;
        }
        
        .white-key {
            flex: 1;
            height: 160px;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 0 0 5px 5px;
            margin-right: 1px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 10px;
            font-weight: bold;
            font-size: 14px;
            position: relative;
        }
        
        .white-key:last-child {
            margin-right: 0;
        }
        
        .black-keys {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }
        
        .black-key {
            position: absolute;
            width: 8.5%;
            height: 100px;
            background-color: #333;
            border-radius: 0 0 3px 3px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 8px;
            color: white;
            font-weight: bold;
            font-size: 12px;
            z-index: 3;
            pointer-events: auto;
        }
        
        /* é»‘é”®ä½ç½® - åœ¨ä¸¤ä¸ªç™½é”®æ­£ä¸­å¤® */
        .black-key.c-sharp { 
            left: calc(14.2857% - 4.285%);
        }
        
        .black-key.d-sharp { 
            left: calc(28.5714% - 4.285%);
        }
        
        .black-key.f-sharp { 
            left: calc(57.1428% - 4.285%);
        }
        
        .black-key.g-sharp { 
            left: calc(71.4285% - 4.285%);
        }
        
        .black-key.a-sharp { 
            left: calc(85.7142% - 4.285%);
        }
        
        /* æ ‡è®°æ ·å¼ */
        .white-key.root {
            background-color: #2ecc71;
            color: white;
        }
        
        .white-key.interval {
            background-color: #e74c3c;
            color: white;
        }
        
        .black-key.root {
            background-color: #27ae60;
            color: white;
        }
        
        .black-key.interval {
            background-color: #c0392b;
            color: white;
        }
        
        .note-explanation {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .note-explanation h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .highlight {
            background-color: #fffacd;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .select-all-container {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .select-all-container label {
            font-weight: bold;
            color: #2c3e50;
            cursor: pointer;
        }
        
        /* æ–°å¢ï¼šé¢˜åº“è¿›åº¦æŒ‡ç¤ºå™¨ */
        .question-progress {
            margin: 15px 0;
            font-size: 1.1em;
            color: #7f8c8d;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .progress-bar {
            flex-grow: 1;
            height: 8px;
            background-color: #ecf0f1;
            border-radius: 4px;
            margin: 0 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #3498db;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .notes-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .note-card {
                width: 140px;
                height: 140px;
            }
            
            .note-symbol {
                font-size: 2.5em;
            }
            
            .arrow-symbol {
                transform: rotate(90deg);
                margin: 10px 0;
            }
            
            .interval-arrow {
                flex-direction: row;
                gap: 10px;
            }
            
            .arrow-text {
                margin-top: 0;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .interval-options {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .interval-table th, .interval-table td {
                padding: 8px 10px;
                font-size: 0.9em;
            }
            
            .keyboard {
                height: 140px;
            }
            
            .white-key {
                height: 120px;
                font-size: 12px;
            }
            
            .black-key {
                height: 80px;
                font-size: 10px;
            }
            
            .black-key.c-sharp { left: calc(14.2857% - 4.285%); }
            .black-key.d-sharp { left: calc(28.5714% - 4.285%); }
            .black-key.f-sharp { left: calc(57.1428% - 4.285%); }
            .black-key.g-sharp { left: calc(71.4285% - 4.285%); }
            .black-key.a-sharp { left: calc(85.7142% - 4.285%); }
            
            .question-progress {
                flex-direction: column;
                gap: 10px;
            }
            
            .progress-bar {
                width: 100%;
                margin: 5px 0;
            }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9em;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .visual-guide {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            gap: 40px;
            flex-wrap: wrap;
        }
        
        .interval-visual {
            text-align: center;
            width: 150px;
        }
        
        .interval-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            margin: 0 auto 15px;
        }
        
        .interval-label {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .interval-desc {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .practice-link {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .practice-link:hover {
            background-color: #2980b9;
        }
        
        /* é”®ç›˜è¯´æ˜ */
        .keyboard-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .legend-color.root {
            background-color: #2ecc71;
        }
        
        .legend-color.interval {
            background-color: #e74c3c;
        }
        
        .exercise-direction {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-top: 10px;
            font-weight: bold;
        }
        
        .musical-note {
            font-size: 1.5em;
            margin-right: 5px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸµ ä¹ç†éŸ³ç¨‹å­¦ä¹ ä¸ç»ƒä¹ </h1>
        <p class="description">å­¦ä¹ éŸ³ç¨‹åŸºç¡€çŸ¥è¯†ï¼Œé€šè¿‡ç»ƒä¹ å·©å›ºæ‰€å­¦å†…å®¹</p>
    </header>
    
    <!-- é€‰é¡¹å¡ -->
    <div class="tabs">
        <button class="tab-btn active" data-tab="learning">ğŸ“š å­¦ä¹ </button>
        <button class="tab-btn" data-tab="practice">ğŸµ ç»ƒä¹ </button>
    </div>
    
    <!-- å­¦ä¹ æ¿å— -->
    <div id="learning" class="tab-content active">
        <div class="learning-panel">
            <h2 class="section-title">ä»€ä¹ˆæ˜¯éŸ³ç¨‹ï¼Ÿ</h2>
            <div class="learning-content">
                <div class="definition-box">
                    <div class="definition-title">éŸ³ç¨‹å®šä¹‰</div>
                    <p>éŸ³ç¨‹æ˜¯æŒ‡ä¸¤ä¸ªéŸ³é«˜ä¹‹é—´çš„è·ç¦»ã€‚åœ¨ä¹ç†ä¸­ï¼ŒéŸ³ç¨‹ç”¨æ¥æè¿°ä¸¤ä¸ªéŸ³ç¬¦ä¹‹é—´çš„é«˜ä½å…³ç³»ï¼Œé€šå¸¸ç”¨"åº¦"æ¥è¡¨ç¤ºã€‚</p>
                    <p>éŸ³ç¨‹ç”±ä¸¤ä¸ªè¦ç´ ç»„æˆï¼š<strong>åº¦æ•°å’ŒéŸ³æ•°</strong>ã€‚</p>
                </div>
                
                <p>ä¾‹å¦‚ï¼Œä»Cåˆ°Eæ˜¯ä¸€ä¸ªéŸ³ç¨‹ï¼Œä»Gåˆ°Cä¹Ÿæ˜¯ä¸€ä¸ªéŸ³ç¨‹ã€‚éŸ³ç¨‹æ˜¯æ„æˆå’Œå¼¦ã€æ—‹å¾‹å’Œå’Œå£°çš„åŸºç¡€ã€‚</p>
                
                <h2 class="section-title">éŸ³ç¨‹çš„æ„æˆè¦ç´ </h2>
                <div class="definition-box">
                    <div class="definition-title">1. åº¦æ•°</div>
                    <p>åº¦æ•°è¡¨ç¤ºéŸ³ç¨‹ä¸­åŒ…å«çš„éŸ³çº§æ•°é‡ï¼Œå³ä¸¤ä¸ªéŸ³ç¬¦åœ¨éŸ³é˜¶ä¸Šçš„ä½ç½®å·®ã€‚</p>
                    <p>ä¾‹å¦‚ï¼šCåˆ°EåŒ…å«Cã€Dã€Eä¸‰ä¸ªéŸ³çº§ï¼Œæ‰€ä»¥æ˜¯ä¸‰åº¦ï¼›Cåˆ°GåŒ…å«Cã€Dã€Eã€Fã€Gäº”ä¸ªéŸ³çº§ï¼Œæ‰€ä»¥æ˜¯äº”åº¦ã€‚</p>
                </div>
                
                <div class="definition-box">
                    <div class="definition-title">2. éŸ³æ•°</div>
                    <p>éŸ³æ•°è¡¨ç¤ºéŸ³ç¨‹ä¸­åŒ…å«çš„åŠéŸ³æ•°é‡ã€‚åŠéŸ³æ˜¯è¥¿æ–¹éŸ³ä¹ä¸­æœ€å°çš„éŸ³é«˜è·ç¦»ã€‚</p>
                    <p>ä¾‹å¦‚ï¼šCåˆ°EåŒ…å«4ä¸ªåŠéŸ³ï¼ˆCâ†’C#â†’Dâ†’D#â†’Eï¼‰ï¼Œæ‰€ä»¥æ˜¯å¤§ä¸‰åº¦ã€‚</p>
                </div>
                
                <h2 class="section-title">éŸ³ç¨‹åˆ†ç±»</h2>
                <table class="interval-table">
                    <thead>
                        <tr>
                            <th>éŸ³ç¨‹åç§°</th>
                            <th>åº¦æ•°</th>
                            <th>åŠéŸ³æ•°</th>
                            <th>ä¸¾ä¾‹</th>
                            <th>æ€§è´¨</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>çº¯ä¸€åº¦</td>
                            <td>ä¸€åº¦</td>
                            <td>0</td>
                            <td>C - C</td>
                            <td>å®Œå…¨åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å°äºŒåº¦</td>
                            <td>äºŒåº¦</td>
                            <td>1</td>
                            <td>C - C#</td>
                            <td>ä¸åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å¤§äºŒåº¦</td>
                            <td>äºŒåº¦</td>
                            <td>2</td>
                            <td>C - D</td>
                            <td>ä¸åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å°ä¸‰åº¦</td>
                            <td>ä¸‰åº¦</td>
                            <td>3</td>
                            <td>C - D#</td>
                            <td>åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å¤§ä¸‰åº¦</td>
                            <td>ä¸‰åº¦</td>
                            <td>4</td>
                            <td>C - E</td>
                            <td>åå’Œ</td>
                        </tr>
                        <tr>
                            <td>çº¯å››åº¦</td>
                            <td>å››åº¦</td>
                            <td>5</td>
                            <td>C - F</td>
                            <td>å®Œå…¨åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å¢å››åº¦/å‡äº”åº¦</td>
                            <td>å››åº¦/äº”åº¦</td>
                            <td>6</td>
                            <td>C - F# / C - Gâ™­</td>
                            <td>ä¸åå’Œ</td>
                        </tr>
                        <tr>
                            <td>çº¯äº”åº¦</td>
                            <td>äº”åº¦</td>
                            <td>7</td>
                            <td>C - G</td>
                            <td>å®Œå…¨åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å°å…­åº¦</td>
                            <td>å…­åº¦</td>
                            <td>8</td>
                            <td>C - G#</td>
                            <td>åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å¤§å…­åº¦</td>
                            <td>å…­åº¦</td>
                            <td>9</td>
                            <td>C - A</td>
                            <td>åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å°ä¸ƒåº¦</td>
                            <td>ä¸ƒåº¦</td>
                            <td>10</td>
                            <td>C - A#</td>
                            <td>ä¸åå’Œ</td>
                        </tr>
                        <tr>
                            <td>å¤§ä¸ƒåº¦</td>
                            <td>ä¸ƒåº¦</td>
                            <td>11</td>
                            <td>C - B</td>
                            <td>ä¸åå’Œ</td>
                        </tr>
                        <tr>
                            <td>çº¯å…«åº¦</td>
                            <td>å…«åº¦</td>
                            <td>12</td>
                            <td>C - C'</td>
                            <td>å®Œå…¨åå’Œ</td>
                        </tr>
                    </tbody>
                </table>
                
                <h2 class="section-title">å¦‚ä½•è¯†åˆ«éŸ³ç¨‹ï¼Ÿ</h2>
                <div class="tip-box">
                    <div class="tip-title">éŸ³ç¨‹è¯†åˆ«æŠ€å·§</div>
                    <ol>
                        <li><strong>è®¡ç®—åº¦æ•°</strong>ï¼šæ•°ä¸¤ä¸ªéŸ³ç¬¦åœ¨éŸ³é˜¶ä¸Šçš„ä½ç½®å·®ï¼ˆåŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰</li>
                        <li><strong>è®¡ç®—åŠéŸ³æ•°</strong>ï¼šç¡®å®šä¸¤ä¸ªéŸ³ç¬¦ä¹‹é—´åŒ…å«å¤šå°‘ä¸ªåŠéŸ³</li>
                        <li><strong>åˆ¤æ–­éŸ³ç¨‹æ€§è´¨</strong>ï¼šæ ¹æ®åŠéŸ³æ•°ç¡®å®šéŸ³ç¨‹æ˜¯å¤§ã€å°ã€çº¯ã€å¢æˆ–å‡</li>
                    </ol>
                </div>
                
                <div class="example-box">
                    <div class="example-title">è¯†åˆ«ç¤ºä¾‹ï¼šC åˆ° E</div>
                    <div class="example-item">
                        <p><strong>æ­¥éª¤1ï¼šè®¡ç®—åº¦æ•°</strong></p>
                        <p>C(1) â†’ D(2) â†’ E(3)ï¼Œæ‰€ä»¥æ˜¯ä¸‰åº¦ã€‚</p>
                    </div>
                    <div class="example-item">
                        <p><strong>æ­¥éª¤2ï¼šè®¡ç®—åŠéŸ³æ•°</strong></p>
                        <p>Cåˆ°C#ï¼ˆ1ä¸ªåŠéŸ³ï¼‰ï¼ŒC#åˆ°Dï¼ˆ1ä¸ªåŠéŸ³ï¼‰ï¼ŒDåˆ°D#ï¼ˆ1ä¸ªåŠéŸ³ï¼‰ï¼ŒD#åˆ°Eï¼ˆ1ä¸ªåŠéŸ³ï¼‰ã€‚æ€»å…±4ä¸ªåŠéŸ³ã€‚</p>
                    </div>
                    <div class="example-item">
                        <p><strong>æ­¥éª¤3ï¼šåˆ¤æ–­æ€§è´¨</strong></p>
                        <p>ä¸‰åº¦éŸ³ç¨‹ä¸­ï¼Œ3ä¸ªåŠéŸ³æ˜¯å°ä¸‰åº¦ï¼Œ4ä¸ªåŠéŸ³æ˜¯å¤§ä¸‰åº¦ã€‚å› æ­¤Cåˆ°Eæ˜¯å¤§ä¸‰åº¦ã€‚</p>
                    </div>
                </div>
                
                <h2 class="section-title">å¸¸è§éŸ³ç¨‹è®°å¿†æ³•</h2>
                <div class="visual-guide">
                    <div class="interval-visual">
                        <div class="interval-circle" style="background-color: #2ecc71;">1</div>
                        <div class="interval-label">å°äºŒåº¦</div>
                        <div class="interval-desc">åŠéŸ³ï¼Œç´§å¼ ä¸å®‰</div>
                    </div>
                    <div class="interval-visual">
                        <div class="interval-circle" style="background-color: #3498db;">2</div>
                        <div class="interval-label">å¤§äºŒåº¦</div>
                        <div class="interval-desc">å…¨éŸ³ï¼Œæ´»æ³¼æ˜å¿«</div>
                    </div>
                    <div class="interval-visual">
                        <div class="interval-circle" style="background-color: #9b59b6;">3</div>
                        <div class="interval-label">å°ä¸‰åº¦</div>
                        <div class="interval-desc">æŸ”å’Œå¿§éƒ</div>
                    </div>
                    <div class="interval-visual">
                        <div class="interval-circle" style="background-color: #e74c3c;">4</div>
                        <div class="interval-label">å¤§ä¸‰åº¦</div>
                        <div class="interval-desc">æ˜äº®æ¬¢å¿«</div>
                    </div>
                    <div class="interval-visual">
                        <div class="interval-circle" style="background-color: #f39c12;">5</div>
                        <div class="interval-label">çº¯äº”åº¦</div>
                        <div class="interval-desc">ç¨³å®šå’Œè°</div>
                    </div>
                </div>
                
                <h2 class="section-title">éŸ³ç¨‹çš„åå’Œæ€§</h2>
                <div class="definition-box">
                    <div class="definition-title">åå’ŒéŸ³ç¨‹ä¸ä¸åå’ŒéŸ³ç¨‹</div>
                    <p><strong>å®Œå…¨åå’ŒéŸ³ç¨‹</strong>ï¼šçº¯ä¸€åº¦ã€çº¯å››åº¦ã€çº¯äº”åº¦ã€çº¯å…«åº¦ã€‚å¬èµ·æ¥éå¸¸ç¨³å®šå’Œè°ã€‚</p>
                    <p><strong>ä¸å®Œå…¨åå’ŒéŸ³ç¨‹</strong>ï¼šå¤§ä¸‰åº¦ã€å°ä¸‰åº¦ã€å¤§å…­åº¦ã€å°å…­åº¦ã€‚å¬èµ·æ¥æ¯”è¾ƒå’Œè°ä½†ä¸å¦‚å®Œå…¨åå’ŒéŸ³ç¨‹ç¨³å®šã€‚</p>
                    <p><strong>ä¸åå’ŒéŸ³ç¨‹</strong>ï¼šå¤§äºŒåº¦ã€å°äºŒåº¦ã€å¤§ä¸ƒåº¦ã€å°ä¸ƒåº¦ã€å¢å››åº¦ã€å‡äº”åº¦ã€‚å¬èµ·æ¥ç´§å¼ ï¼Œéœ€è¦è§£å†³åˆ°åå’ŒéŸ³ç¨‹ã€‚</p>
                </div>
                
                <div class="tip-box">
                    <div class="tip-title">å­¦ä¹ å»ºè®®</div>
                    <p>1. ä»ç®€å•çš„éŸ³ç¨‹å¼€å§‹ç»ƒä¹ ï¼Œå¦‚ä¸‰åº¦ã€å››åº¦ã€äº”åº¦</p>
                    <p>2. å¤šå¬ä¸åŒéŸ³ç¨‹çš„éŸ³å“æ•ˆæœï¼ŒåŸ¹å…»å¬è§‰è®°å¿†</p>
                    <p>3. ç»“åˆé’¢ç´é”®ç›˜ç†è§£éŸ³ç¨‹çš„åŠéŸ³å…³ç³»</p>
                    <p>4. ä½¿ç”¨ä¸‹é¢çš„ç»ƒä¹ æ¿å—å·©å›ºæ‰€å­¦çŸ¥è¯†</p>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <a href="#" class="practice-link" id="goToPractice">ç«‹å³å¼€å§‹ç»ƒä¹  â†’</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ç»ƒä¹ æ¿å— -->
    <div id="practice" class="tab-content">
        <div class="practice-panel">
            <div class="control-panel">
                <h2 class="panel-title">âš™ï¸ ç»ƒä¹ è®¾ç½®</h2>
                
                <div class="settings-group">
                    <div class="settings-title">é€‰æ‹©ç»ƒä¹ éŸ³ç¨‹ç±»å‹ï¼š</div>
                    <div class="select-all-container">
                        <input type="checkbox" id="selectAllIntervals">
                        <label for="selectAllIntervals">å…¨é€‰/å…¨ä¸é€‰</label>
                    </div>
                    <div class="options-grid" id="interval-types">
                        <!-- åŠ¨æ€ç”ŸæˆéŸ³ç¨‹é€‰é¡¹ -->
                    </div>
                </div>
                
                <div class="settings-group">
                    <div class="settings-title">ç»ƒä¹ æ¨¡å¼ï¼š</div>
                    <div class="options-grid">
                        <div class="option-item">
                            <input type="radio" id="practiceModeRandom" name="practiceMode" value="random" checked>
                            <label for="practiceModeRandom">éšæœºç”Ÿæˆ</label>
                        </div>
                        <div class="option-item">
                            <input type="radio" id="practiceModeBank" name="practiceMode" value="bank">
                            <label for="practiceModeBank">é¢˜åº“ç»ƒä¹  (60é¢˜)</label>
                        </div>
                    </div>
                </div>
                
                <div class="settings-group">
                    <div class="settings-title">å…¶ä»–é€‰é¡¹ï¼š</div>
                    <div class="options-grid">
                        <div class="option-item">
                            <input type="checkbox" id="includeDescending" checked>
                            <label for="includeDescending">åŒ…å«ä¸‹è¡ŒéŸ³ç¨‹</label>
                        </div>
                        <div class="option-item">
                            <input type="checkbox" id="includeCompound" checked>
                            <label for="includeCompound">åŒ…å«å¤éŸ³ç¨‹ï¼ˆè¶…è¿‡å…«åº¦ï¼‰</label>
                        </div>
                        <div class="option-item">
                            <input type="checkbox" id="showKeyboard" checked>
                            <label for="showKeyboard">æ˜¾ç¤ºé’¢ç´é”®ç›˜</label>
                        </div>
                        <div class="option-item">
                            <input type="checkbox" id="autoNext" checked>
                            <label for="autoNext">å›ç­”åè‡ªåŠ¨ä¸‹ä¸€é¢˜</label>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="primary-btn" id="startBtn">
                        <span>â–¶ï¸</span> å¼€å§‹ç»ƒä¹ 
                    </button>
                    <button class="secondary-btn" id="nextBtn" disabled>
                        <span>â­ï¸</span> ä¸‹ä¸€é¢˜
                    </button>
                    <button class="reset-btn" id="resetBtn">
                        <span>ğŸ”„</span> é‡ç½®ç»Ÿè®¡
                    </button>
                </div>
            </div>
            
            <div class="exercise-panel" id="exercisePanel">
                <h2 class="panel-title">ğŸ¼ éŸ³ç¨‹è¯†åˆ«ç»ƒä¹ </h2>
                
                <!-- é¢˜åº“è¿›åº¦æŒ‡ç¤ºå™¨ -->
                <div class="question-progress" id="questionProgress" style="display: none;">
                    <div id="currentQuestion">ç¬¬1é¢˜</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                    </div>
                    <div id="totalQuestions">/60é¢˜</div>
                </div>
                
                <div class="exercise-content">
                    <!-- é¢˜ç›®è¡¨ç°æ ·å¼ -->
                    <div class="question-container">
                        <div class="question-title" id="questionText">è¯†åˆ«ä»¥ä¸‹ä¸¤ä¸ªéŸ³ç¬¦ä¹‹é—´çš„éŸ³ç¨‹ï¼š</div>
                        
                        <div class="notes-container">
                            <div class="note-item">
                                <div class="note-label">èµ·å§‹éŸ³</div>
                                <div class="note-card start">
                                    <div class="note-symbol" id="firstNote">C</div>
                                </div>
                            </div>
                            
                            <div class="interval-arrow">
                                <div class="arrow-symbol">â†’</div>
                                <div class="arrow-text" id="arrowText">éŸ³ç¨‹æ–¹å‘</div>
                            </div>
                            
                            <div class="note-item">
                                <div class="note-label">ç»“æŸéŸ³</div>
                                <div class="note-card end">
                                    <div class="note-symbol" id="secondNote">E</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="keyboardContainer">
                        <!-- é’¢ç´é”®ç›˜ä¼šåœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    
                    <!-- é”®ç›˜å›¾ä¾‹ -->
                    <div class="keyboard-legend" id="keyboardLegend" style="display: none;">
                        <div class="legend-item">
                            <div class="legend-color root"></div>
                            <span>èµ·å§‹éŸ³</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color interval"></div>
                            <span>ç»“æŸéŸ³</span>
                        </div>
                    </div>
                    
                    <div id="intervalOptions" class="interval-options">
                        <!-- éŸ³ç¨‹é€‰é¡¹ä¼šåœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    
                    <div id="noteExplanation" class="note-explanation" style="display: none;">
                        <h3>éŸ³ç¨‹è§£æ</h3>
                        <p id="explanationText"></p>
                    </div>
                </div>
            </div>
            
            <div class="result-panel" id="resultPanel">
                <h2 class="panel-title">ğŸ“Š ç­”é¢˜ç»“æœ</h2>
                
                <div class="result-content">
                    <div class="result-icon" id="resultIcon">âœ“</div>
                    <div class="result-text" id="resultText">å›ç­”æ­£ç¡®ï¼</div>
                    <div class="result-details" id="resultDetails">C åˆ° E æ˜¯å¤§ä¸‰åº¦ï¼ŒåŒ…å« 4 ä¸ªåŠéŸ³</div>
                    
                    <div class="button-group">
                        <button class="primary-btn" id="continueBtn">
                            <span>â­ï¸</span> ç»§ç»­ç»ƒä¹ 
                        </button>
                    </div>
                    
                    <div class="stats">
                        <div class="stat-item">
                            <div class="stat-value" id="correctCount">0</div>
                            <div class="stat-label">æ­£ç¡®</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalCount">0</div>
                            <div class="stat-label">æ€»è®¡</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="accuracyRate">0%</div>
                            <div class="stat-label">æ­£ç¡®ç‡</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>ä¹ç†éŸ³ç¨‹å­¦ä¹ ä¸ç»ƒä¹  | å¸®åŠ©éŸ³ä¹å­¦ä¹ è€…æŒæ¡éŸ³ç¨‹çŸ¥è¯†</p>
        <p>æç¤ºï¼šéŸ³ç¨‹ç”±"åº¦"å’Œ"æ€§è´¨"ç»„æˆï¼Œå¦‚"å¤§ä¸‰åº¦"ã€"çº¯äº”åº¦"ç­‰</p>
    </footer>

    <script>
        // éŸ³ç¨‹æ•°æ®
        const intervals = [
            { name: "çº¯ä¸€åº¦", semitones: 0, type: "perfect", description: "ç›¸åŒéŸ³é«˜çš„ä¸¤ä¸ªéŸ³" },
            { name: "å°äºŒåº¦", semitones: 1, type: "minor", description: "åŒ…å«1ä¸ªåŠéŸ³" },
            { name: "å¤§äºŒåº¦", semitones: 2, type: "major", description: "åŒ…å«2ä¸ªåŠéŸ³" },
            { name: "å°ä¸‰åº¦", semitones: 3, type: "minor", description: "åŒ…å«3ä¸ªåŠéŸ³" },
            { name: "å¤§ä¸‰åº¦", semitones: 4, type: "major", description: "åŒ…å«4ä¸ªåŠéŸ³" },
            { name: "çº¯å››åº¦", semitones: 5, type: "perfect", description: "åŒ…å«5ä¸ªåŠéŸ³" },
            { name: "å¢å››åº¦/å‡äº”åº¦", semitones: 6, type: "tritone", description: "åŒ…å«6ä¸ªåŠéŸ³ï¼ˆä¸‰å…¨éŸ³ï¼‰" },
            { name: "çº¯äº”åº¦", semitones: 7, type: "perfect", description: "åŒ…å«7ä¸ªåŠéŸ³" },
            { name: "å°å…­åº¦", semitones: 8, type: "minor", description: "åŒ…å«8ä¸ªåŠéŸ³" },
            { name: "å¤§å…­åº¦", semitones: 9, type: "major", description: "åŒ…å«9ä¸ªåŠéŸ³" },
            { name: "å°ä¸ƒåº¦", semitones: 10, type: "minor", description: "åŒ…å«10ä¸ªåŠéŸ³" },
            { name: "å¤§ä¸ƒåº¦", semitones: 11, type: "major", description: "åŒ…å«11ä¸ªåŠéŸ³" },
            { name: "çº¯å…«åº¦", semitones: 12, type: "perfect", description: "åŒ…å«12ä¸ªåŠéŸ³" }
        ];

        // éŸ³ç¬¦æ•°æ® - åŒ…å«é”®ç›˜ç±»å‹ä¿¡æ¯
        const notes = [
            { name: "C", position: 0, type: "white", keyName: "C", blackKey: false },
            { name: "C#/Db", position: 1, type: "black", keyName: "C#", blackKey: true },
            { name: "D", position: 2, type: "white", keyName: "D", blackKey: false },
            { name: "D#/Eb", position: 3, type: "black", keyName: "D#", blackKey: true },
            { name: "E", position: 4, type: "white", keyName: "E", blackKey: false },
            { name: "F", position: 5, type: "white", keyName: "F", blackKey: false },
            { name: "F#/Gb", position: 6, type: "black", keyName: "F#", blackKey: true },
            { name: "G", position: 7, type: "white", keyName: "G", blackKey: false },
            { name: "G#/Ab", position: 8, type: "black", keyName: "G#", blackKey: true },
            { name: "A", position: 9, type: "white", keyName: "A", blackKey: false },
            { name: "A#/Bb", position: 10, type: "black", keyName: "A#", blackKey: true },
            { name: "B", position: 11, type: "white", keyName: "B", blackKey: false }
        ];

        // é¢˜åº“æ•°æ® - 60é“é¢„å®šä¹‰çš„éŸ³ç¨‹é¢˜ç›®
        const questionBank = [
            // ç¬¬1-10é¢˜ï¼šåŸºæœ¬éŸ³ç¨‹ï¼ˆå°äºŒåº¦ã€å¤§äºŒåº¦ï¼‰
            { startNote: "C", targetNote: "C#/Db", correctAnswer: "å°äºŒåº¦", isAscending: true, intervalName: "å°äºŒåº¦" },
            { startNote: "E", targetNote: "F", correctAnswer: "å°äºŒåº¦", isAscending: true, intervalName: "å°äºŒåº¦" },
            { startNote: "G", targetNote: "G#/Ab", correctAnswer: "å°äºŒåº¦", isAscending: true, intervalName: "å°äºŒåº¦" },
            { startNote: "C", targetNote: "D", correctAnswer: "å¤§äºŒåº¦", isAscending: true, intervalName: "å¤§äºŒåº¦" },
            { startNote: "F", targetNote: "G", correctAnswer: "å¤§äºŒåº¦", isAscending: true, intervalName: "å¤§äºŒåº¦" },
            { startNote: "A", targetNote: "B", correctAnswer: "å¤§äºŒåº¦", isAscending: true, intervalName: "å¤§äºŒåº¦" },
            { startNote: "D", targetNote: "E", correctAnswer: "å¤§äºŒåº¦", isAscending: true, intervalName: "å¤§äºŒåº¦" },
            { startNote: "G", targetNote: "A", correctAnswer: "å¤§äºŒåº¦", isAscending: true, intervalName: "å¤§äºŒåº¦" },
            { startNote: "B", targetNote: "A#/Bb", correctAnswer: "å°äºŒåº¦", isAscending: false, intervalName: "å°äºŒåº¦" },
            { startNote: "E", targetNote: "D", correctAnswer: "å¤§äºŒåº¦", isAscending: false, intervalName: "å¤§äºŒåº¦" },
            
            // ç¬¬11-20é¢˜ï¼šä¸‰åº¦éŸ³ç¨‹ï¼ˆå°ä¸‰åº¦ã€å¤§ä¸‰åº¦ï¼‰
            { startNote: "D", targetNote: "F", correctAnswer: "å°ä¸‰åº¦", isAscending: true, intervalName: "å°ä¸‰åº¦" },
            { startNote: "E", targetNote: "G", correctAnswer: "å°ä¸‰åº¦", isAscending: true, intervalName: "å°ä¸‰åº¦" },
            { startNote: "A", targetNote: "C", correctAnswer: "å°ä¸‰åº¦", isAscending: false, intervalName: "å°ä¸‰åº¦" },
            { startNote: "C", targetNote: "E", correctAnswer: "å¤§ä¸‰åº¦", isAscending: true, intervalName: "å¤§ä¸‰åº¦" },
            { startNote: "F", targetNote: "A", correctAnswer: "å¤§ä¸‰åº¦", isAscending: true, intervalName: "å¤§ä¸‰åº¦" },
            { startNote: "G", targetNote: "B", correctAnswer: "å¤§ä¸‰åº¦", isAscending: true, intervalName: "å¤§ä¸‰åº¦" },
            { startNote: "B", targetNote: "G", correctAnswer: "å°ä¸‰åº¦", isAscending: false, intervalName: "å°ä¸‰åº¦" },
            { startNote: "D", targetNote: "B", correctAnswer: "å¤§ä¸‰åº¦", isAscending: false, intervalName: "å¤§ä¸‰åº¦" },
            { startNote: "A", targetNote: "F#/Gb", correctAnswer: "å°ä¸‰åº¦", isAscending: true, intervalName: "å°ä¸‰åº¦" },
            { startNote: "E", targetNote: "C#/Db", correctAnswer: "å°ä¸‰åº¦", isAscending: true, intervalName: "å°ä¸‰åº¦" },
            
            // ç¬¬21-30é¢˜ï¼šå››åº¦éŸ³ç¨‹ï¼ˆçº¯å››åº¦ã€å¢å››åº¦ï¼‰
            { startNote: "C", targetNote: "F", correctAnswer: "çº¯å››åº¦", isAscending: true, intervalName: "çº¯å››åº¦" },
            { startNote: "G", targetNote: "C", correctAnswer: "çº¯å››åº¦", isAscending: false, intervalName: "çº¯å››åº¦" },
            { startNote: "D", targetNote: "G", correctAnswer: "çº¯å››åº¦", isAscending: true, intervalName: "çº¯å››åº¦" },
            { startNote: "A", targetNote: "D", correctAnswer: "çº¯å››åº¦", isAscending: false, intervalName: "çº¯å››åº¦" },
            { startNote: "E", targetNote: "A", correctAnswer: "çº¯å››åº¦", isAscending: false, intervalName: "çº¯å››åº¦" },
            { startNote: "C", targetNote: "F#/Gb", correctAnswer: "å¢å››åº¦/å‡äº”åº¦", isAscending: true, intervalName: "å¢å››åº¦/å‡äº”åº¦" },
            { startNote: "F", targetNote: "B", correctAnswer: "å¢å››åº¦/å‡äº”åº¦", isAscending: true, intervalName: "å¢å››åº¦/å‡äº”åº¦" },
            { startNote: "B", targetNote: "F", correctAnswer: "å¢å››åº¦/å‡äº”åº¦", isAscending: false, intervalName: "å¢å››åº¦/å‡äº”åº¦" },
            { startNote: "G", targetNote: "C#/Db", correctAnswer: "å¢å››åº¦/å‡äº”åº¦", isAscending: true, intervalName: "å¢å››åº¦/å‡äº”åº¦" },
            { startNote: "D", targetNote: "G#/Ab", correctAnswer: "å¢å››åº¦/å‡äº”åº¦", isAscending: true, intervalName: "å¢å››åº¦/å‡äº”åº¦" },
            
            // ç¬¬31-40é¢˜ï¼šäº”åº¦éŸ³ç¨‹ï¼ˆçº¯äº”åº¦ï¼‰
            { startNote: "C", targetNote: "G", correctAnswer: "çº¯äº”åº¦", isAscending: true, intervalName: "çº¯äº”åº¦" },
            { startNote: "D", targetNote: "A", correctAnswer: "çº¯äº”åº¦", isAscending: true, intervalName: "çº¯äº”åº¦" },
            { startNote: "E", targetNote: "B", correctAnswer: "çº¯äº”åº¦", isAscending: true, intervalName: "çº¯äº”åº¦" },
            { startNote: "F", targetNote: "C", correctAnswer: "çº¯äº”åº¦", isAscending: false, intervalName: "çº¯äº”åº¦" },
            { startNote: "G", targetNote: "D", correctAnswer: "çº¯äº”åº¦", isAscending: false, intervalName: "çº¯äº”åº¦" },
            { startNote: "A", targetNote: "E", correctAnswer: "çº¯äº”åº¦", isAscending: false, intervalName: "çº¯äº”åº¦" },
            { startNote: "B", targetNote: "F#/Gb", correctAnswer: "çº¯äº”åº¦", isAscending: false, intervalName: "çº¯äº”åº¦" },
            { startNote: "F#/Gb", targetNote: "C#/Db", correctAnswer: "çº¯äº”åº¦", isAscending: false, intervalName: "çº¯äº”åº¦" },
            { startNote: "C#/Db", targetNote: "G#/Ab", correctAnswer: "çº¯äº”åº¦", isAscending: true, intervalName: "çº¯äº”åº¦" },
            { startNote: "G#/Ab", targetNote: "D#/Eb", correctAnswer: "çº¯äº”åº¦", isAscending: true, intervalName: "çº¯äº”åº¦" },
            
            // ç¬¬41-50é¢˜ï¼šå…­åº¦éŸ³ç¨‹ï¼ˆå°å…­åº¦ã€å¤§å…­åº¦ï¼‰
            { startNote: "E", targetNote: "C", correctAnswer: "å°å…­åº¦", isAscending: false, intervalName: "å°å…­åº¦" },
            { startNote: "A", targetNote: "F", correctAnswer: "å°å…­åº¦", isAscending: false, intervalName: "å°å…­åº¦" },
            { startNote: "C", targetNote: "A", correctAnswer: "å¤§å…­åº¦", isAscending: true, intervalName: "å¤§å…­åº¦" },
            { startNote: "D", targetNote: "B", correctAnswer: "å¤§å…­åº¦", isAscending: true, intervalName: "å¤§å…­åº¦" },
            { startNote: "F", targetNote: "D", correctAnswer: "å¤§å…­åº¦", isAscending: false, intervalName: "å¤§å…­åº¦" },
            { startNote: "G", targetNote: "E", correctAnswer: "å°å…­åº¦", isAscending: false, intervalName: "å°å…­åº¦" },
            { startNote: "B", targetNote: "G", correctAnswer: "å°å…­åº¦", isAscending: false, intervalName: "å°å…­åº¦" },
            { startNote: "E", targetNote: "C#/Db", correctAnswer: "å¤§å…­åº¦", isAscending: true, intervalName: "å¤§å…­åº¦" },
            { startNote: "A", targetNote: "F#/Gb", correctAnswer: "å¤§å…­åº¦", isAscending: true, intervalName: "å¤§å…­åº¦" },
            { startNote: "D", targetNote: "B", correctAnswer: "å¤§å…­åº¦", isAscending: true, intervalName: "å¤§å…­åº¦" },
            
            // ç¬¬51-60é¢˜ï¼šä¸ƒåº¦éŸ³ç¨‹ã€å…«åº¦éŸ³ç¨‹åŠå…¶ä»–
            { startNote: "D", targetNote: "C", correctAnswer: "å°ä¸ƒåº¦", isAscending: false, intervalName: "å°ä¸ƒåº¦" },
            { startNote: "E", targetNote: "D", correctAnswer: "å°ä¸ƒåº¦", isAscending: false, intervalName: "å°ä¸ƒåº¦" },
            { startNote: "C", targetNote: "B", correctAnswer: "å¤§ä¸ƒåº¦", isAscending: true, intervalName: "å¤§ä¸ƒåº¦" },
            { startNote: "F", targetNote: "E", correctAnswer: "å¤§ä¸ƒåº¦", isAscending: false, intervalName: "å¤§ä¸ƒåº¦" },
            { startNote: "G", targetNote: "F#/Gb", correctAnswer: "å¤§ä¸ƒåº¦", isAscending: true, intervalName: "å¤§ä¸ƒåº¦" },
            { startNote: "C", targetNote: "C", correctAnswer: "çº¯ä¸€åº¦", isAscending: true, intervalName: "çº¯ä¸€åº¦" },
            { startNote: "G", targetNote: "G", correctAnswer: "çº¯ä¸€åº¦", isAscending: true, intervalName: "çº¯ä¸€åº¦" },
            { startNote: "C", targetNote: "C'(+1å…«åº¦)", correctAnswer: "çº¯å…«åº¦", isAscending: true, intervalName: "çº¯å…«åº¦" },
            { startNote: "F", targetNote: "F'(+1å…«åº¦)", correctAnswer: "çº¯å…«åº¦", isAscending: true, intervalName: "çº¯å…«åº¦" },
            { startNote: "G", targetNote: "G'(+1å…«åº¦)", correctAnswer: "çº¯å…«åº¦", isAscending: true, intervalName: "çº¯å…«åº¦" }
        ];

        // åº”ç”¨çŠ¶æ€
        const state = {
            selectedIntervals: ["å°ä¸‰åº¦", "å¤§ä¸‰åº¦", "çº¯å››åº¦", "çº¯äº”åº¦"], // é»˜è®¤é€‰æ‹©çš„éŸ³ç¨‹
            currentExercise: null,
            userAnswer: null,
            isAnswered: false,
            stats: {
                total: 0,
                correct: 0
            },
            practiceMode: "random", // "random" æˆ– "bank"
            currentBankIndex: 0,
            questionBankUsed: []
        };

        // DOMå…ƒç´  - åœ¨initAppä¸­åˆå§‹åŒ–
        let intervalTypesContainer, startBtn, nextBtn, resetBtn, continueBtn;
        let exercisePanel, resultPanel, questionText, firstNote, secondNote;
        let keyboardContainer, intervalOptions, noteExplanation, explanationText;
        let resultIcon, resultText, resultDetails, correctCount, totalCount, accuracyRate;
        let includeDescending, includeCompound, showKeyboard, autoNext, selectAllIntervals;
        let tabButtons, tabContents, goToPracticeBtn, keyboardLegend;
        let practiceModeRandom, practiceModeBank, questionProgress, currentQuestion, progressFill, totalQuestions, arrowText;

        // åˆå§‹åŒ–éŸ³ç¨‹é€‰é¡¹
        function initIntervalOptions() {
            intervals.forEach(interval => {
                const optionId = `interval-${interval.name}`;
                const isChecked = state.selectedIntervals.includes(interval.name);
                
                const optionItem = document.createElement('div');
                optionItem.className = 'option-item';
                optionItem.innerHTML = `
                    <input type="checkbox" id="${optionId}" ${isChecked ? 'checked' : ''}>
                    <label for="${optionId}">${interval.name}</label>
                `;
                
                intervalTypesContainer.appendChild(optionItem);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬
                document.getElementById(optionId).addEventListener('change', function() {
                    if (this.checked) {
                        if (!state.selectedIntervals.includes(interval.name)) {
                            state.selectedIntervals.push(interval.name);
                        }
                    } else {
                        const index = state.selectedIntervals.indexOf(interval.name);
                        if (index !== -1) {
                            state.selectedIntervals.splice(index, 1);
                        }
                    }
                    
                    // æ›´æ–°å…¨é€‰å¤é€‰æ¡†çŠ¶æ€
                    updateSelectAllCheckbox();
                });
            });
            
            // åˆå§‹åŒ–å…¨é€‰å¤é€‰æ¡†
            updateSelectAllCheckbox();
        }

        // æ›´æ–°å…¨é€‰å¤é€‰æ¡†çŠ¶æ€
        function updateSelectAllCheckbox() {
            const allChecked = state.selectedIntervals.length === intervals.length;
            selectAllIntervals.checked = allChecked;
        }

        // å¤„ç†å…¨é€‰å¤é€‰æ¡†ç‚¹å‡»
        function handleSelectAllClick() {
            const isChecked = selectAllIntervals.checked;
            
            if (isChecked) {
                // å…¨é€‰æ‰€æœ‰éŸ³ç¨‹
                state.selectedIntervals = intervals.map(interval => interval.name);
            } else {
                // æ¸…ç©ºæ‰€æœ‰éŸ³ç¨‹é€‰æ‹©
                state.selectedIntervals = [];
            }
            
            // æ›´æ–°æ‰€æœ‰å¤é€‰æ¡†çš„é€‰ä¸­çŠ¶æ€
            intervals.forEach(interval => {
                const checkbox = document.getElementById(`interval-${interval.name}`);
                if (checkbox) {
                    checkbox.checked = isChecked;
                }
            });
        }

        // å¤„ç†ç»ƒä¹ æ¨¡å¼åˆ‡æ¢
        function handlePracticeModeChange() {
            if (practiceModeRandom.checked) {
                state.practiceMode = "random";
                questionProgress.style.display = "none";
            } else {
                state.practiceMode = "bank";
                questionProgress.style.display = "flex";
                // åˆå§‹åŒ–é¢˜åº“ä½¿ç”¨çŠ¶æ€
                if (state.questionBankUsed.length === 0) {
                    state.questionBankUsed = new Array(questionBank.length).fill(false);
                }
            }
        }

        // ä»é¢˜åº“ä¸­è·å–ä¸‹ä¸€é“é¢˜ç›®
        function getNextQuestionFromBank() {
            // æ‰¾åˆ°æœªä½¿ç”¨çš„é¢˜ç›®
            const availableIndices = state.questionBankUsed
                .map((used, index) => used ? -1 : index)
                .filter(index => index !== -1);
            
            // å¦‚æœæ‰€æœ‰é¢˜ç›®éƒ½å·²ä½¿ç”¨ï¼Œé‡ç½®ä½¿ç”¨çŠ¶æ€
            if (availableIndices.length === 0) {
                state.questionBankUsed = new Array(questionBank.length).fill(false);
                // é‡æ–°è·å–
                return getNextQuestionFromBank();
            }
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªæœªä½¿ç”¨çš„é¢˜ç›®
            const randomIndex = Math.floor(Math.random() * availableIndices.length);
            const questionIndex = availableIndices[randomIndex];
            
            // æ ‡è®°ä¸ºå·²ä½¿ç”¨
            state.questionBankUsed[questionIndex] = true;
            state.currentBankIndex = questionIndex;
            
            return questionBank[questionIndex];
        }

        // ç”ŸæˆéšæœºéŸ³ç¨‹ç»ƒä¹ 
        function generateExercise() {
            // æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†éŸ³ç¨‹
            if (state.selectedIntervals.length === 0 && state.practiceMode === "random") {
                alert("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªéŸ³ç¨‹ç±»å‹è¿›è¡Œç»ƒä¹ ï¼");
                return;
            }
            
            // æ ¹æ®ç»ƒä¹ æ¨¡å¼ç”Ÿæˆé¢˜ç›®
            if (state.practiceMode === "bank") {
                generateExerciseFromBank();
            } else {
                generateRandomExercise();
            }
        }

        // ä»é¢˜åº“ç”Ÿæˆé¢˜ç›®
        function generateExerciseFromBank() {
            const question = getNextQuestionFromBank();
            
            // æ‰¾åˆ°èµ·å§‹éŸ³ç¬¦
            const startNoteObj = notes.find(note => note.name === question.startNote.replace(/\(.*\)/, "")) || notes[0];
            
            // æ‰¾åˆ°ç›®æ ‡éŸ³ç¬¦
            const targetNoteName = question.targetNote.replace(/\(.*\)/, "");
            const targetNoteObj = notes.find(note => note.name === targetNoteName) || notes[0];
            
            // æ‰¾åˆ°å¯¹åº”çš„éŸ³ç¨‹æ•°æ®
            const interval = intervals.find(i => i.name === question.correctAnswer);
            
            // ç”Ÿæˆå¹²æ‰°é€‰é¡¹ï¼ˆæ­£ç¡®ç­”æ¡ˆ + 3ä¸ªé”™è¯¯ç­”æ¡ˆï¼‰
            const correctAnswer = question.correctAnswer;
            let wrongAnswers = [];
            
            // ç¡®ä¿å¹²æ‰°é¡¹ä¸åŒäºæ­£ç¡®ç­”æ¡ˆ
            while (wrongAnswers.length < 3) {
                const randomInterval = intervals[Math.floor(Math.random() * intervals.length)];
                if (randomInterval.name !== correctAnswer && !wrongAnswers.includes(randomInterval.name)) {
                    wrongAnswers.push(randomInterval.name);
                }
            }
            
            // åˆå¹¶æ‰€æœ‰é€‰é¡¹å¹¶éšæœºæ’åº
            const allAnswers = [correctAnswer, ...wrongAnswers].sort(() => Math.random() - 0.5);
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å…«åº¦æ ‡è®°
            const octaveMatch = question.targetNote.match(/\(([^)]+)\)/);
            let octaveDifference = 0;
            if (octaveMatch) {
                const octaveText = octaveMatch[1];
                if (octaveText.includes("+1å…«åº¦")) {
                    octaveDifference = 1;
                }
            }
            
            // å­˜å‚¨å½“å‰ç»ƒä¹ 
            state.currentExercise = {
                startNote: question.startNote,
                targetNote: question.targetNote,
                startNoteObj: startNoteObj,
                targetNoteObj: targetNoteObj,
                isAscending: question.isAscending,
                correctAnswer: correctAnswer,
                allAnswers: allAnswers,
                interval: interval,
                octaveDifference: octaveDifference,
                startPosition: startNoteObj.position,
                targetPosition: targetNoteObj.position + (octaveDifference * 12),
                fromBank: true,
                bankIndex: state.currentBankIndex
            };
            
            state.userAnswer = null;
            state.isAnswered = false;
            
            // æ›´æ–°UI
            updateExerciseUI();
        }

        // ç”ŸæˆéšæœºéŸ³ç¨‹ç»ƒä¹ 
        function generateRandomExercise() {
            // ä»é€‰ä¸­çš„éŸ³ç¨‹ä¸­éšæœºé€‰æ‹©ä¸€ä¸ª
            const intervalName = state.selectedIntervals[Math.floor(Math.random() * state.selectedIntervals.length)];
            const interval = intervals.find(i => i.name === intervalName);
            
            // éšæœºé€‰æ‹©èµ·å§‹éŸ³ç¬¦
            const startNoteIndex = Math.floor(Math.random() * notes.length);
            const startNote = notes[startNoteIndex];
            
            // å†³å®šæ–¹å‘ï¼šä¸Šè¡Œæˆ–ä¸‹è¡Œ
            const isAscending = includeDescending.checked ? Math.random() > 0.5 : true;
            
            // è®¡ç®—ç›®æ ‡éŸ³ç¬¦ä½ç½®
            let targetPosition;
            if (isAscending) {
                targetPosition = startNote.position + interval.semitones;
            } else {
                targetPosition = startNote.position - interval.semitones;
            }
            
            // å¤„ç†è¶…è¿‡å…«åº¦çš„æƒ…å†µ
            if (includeCompound.checked && Math.random() > 0.7) {
                // 30%çš„æ¦‚ç‡ç”Ÿæˆå¤éŸ³ç¨‹ï¼ˆè¶…è¿‡å…«åº¦ï¼‰
                const octaveShift = Math.floor(Math.random() * 2) + 1; // 1-2ä¸ªå…«åº¦
                if (isAscending) {
                    targetPosition += 12 * octaveShift;
                } else {
                    targetPosition -= 12 * octaveShift;
                }
            }
            
            // ç¡®ä¿ç›®æ ‡ä½ç½®åœ¨åˆç†èŒƒå›´å†…ï¼ˆ0-23ï¼Œå¯¹åº”ä¸¤ä¸ªå…«åº¦ï¼‰
            targetPosition = ((targetPosition % 24) + 24) % 24;
            
            // æ‰¾åˆ°ç›®æ ‡éŸ³ç¬¦
            const targetNote = notes[targetPosition % 12];
            const octaveDifference = Math.floor(targetPosition / 12) - Math.floor(startNote.position / 12);
            
            // æ„å»ºå®Œæ•´çš„éŸ³ç¬¦æ˜¾ç¤ºï¼ˆåŒ…æ‹¬å…«åº¦ä¿¡æ¯ï¼‰
            let startNoteDisplay = startNote.name;
            let targetNoteDisplay = targetNote.name;
            
            // å¦‚æœæœ‰å…«åº¦å˜åŒ–ï¼Œæ·»åŠ å…«åº¦æ ‡è®°
            if (octaveDifference > 0) {
                targetNoteDisplay += `(+${octaveDifference}å…«åº¦)`;
            } else if (octaveDifference < 0) {
                targetNoteDisplay += `(${octaveDifference}å…«åº¦)`;
            }
            
            // ç”Ÿæˆå¹²æ‰°é€‰é¡¹ï¼ˆæ­£ç¡®ç­”æ¡ˆ + 3ä¸ªé”™è¯¯ç­”æ¡ˆï¼‰
            const correctAnswer = interval.name;
            let wrongAnswers = [];
            
            // ç¡®ä¿å¹²æ‰°é¡¹ä¸åŒäºæ­£ç¡®ç­”æ¡ˆ
            while (wrongAnswers.length < 3) {
                const randomInterval = intervals[Math.floor(Math.random() * intervals.length)];
                if (randomInterval.name !== correctAnswer && !wrongAnswers.includes(randomInterval.name)) {
                    wrongAnswers.push(randomInterval.name);
                }
            }
            
            // åˆå¹¶æ‰€æœ‰é€‰é¡¹å¹¶éšæœºæ’åº
            const allAnswers = [correctAnswer, ...wrongAnswers].sort(() => Math.random() - 0.5);
            
            // å­˜å‚¨å½“å‰ç»ƒä¹ 
            state.currentExercise = {
                startNote: startNoteDisplay,
                targetNote: targetNoteDisplay,
                startNoteObj: startNote,
                targetNoteObj: targetNote,
                isAscending,
                correctAnswer,
                allAnswers,
                interval,
                octaveDifference,
                startPosition: startNote.position,
                targetPosition: targetPosition,
                fromBank: false
            };
            
            state.userAnswer = null;
            state.isAnswered = false;
            
            // æ›´æ–°UI
            updateExerciseUI();
        }

        // æ›´æ–°ç»ƒä¹ UI
        function updateExerciseUI() {
            const exercise = state.currentExercise;
            
            // æ›´æ–°é—®é¢˜æ–‡æœ¬
            questionText.textContent = `è¯†åˆ«ä»¥ä¸‹ä¸¤ä¸ªéŸ³ç¬¦ä¹‹é—´çš„éŸ³ç¨‹ï¼š`;
            
            // æ›´æ–°éŸ³ç¬¦æ˜¾ç¤º
            firstNote.textContent = exercise.startNote;
            secondNote.textContent = exercise.targetNote;
            
            // æ›´æ–°ç®­å¤´æ–¹å‘æ–‡æœ¬
            arrowText.textContent = exercise.isAscending ? 'ä¸Šè¡ŒéŸ³ç¨‹' : 'ä¸‹è¡ŒéŸ³ç¨‹';
            
            // å¦‚æœæ˜¯é¢˜åº“æ¨¡å¼ï¼Œæ›´æ–°è¿›åº¦
            if (state.practiceMode === "bank") {
                const currentQ = state.currentBankIndex + 1;
                const totalQ = questionBank.length;
                currentQuestion.textContent = `ç¬¬${currentQ}é¢˜`;
                totalQuestions.textContent = `/60é¢˜`;
                const progressPercent = (currentQ / totalQ) * 100;
                progressFill.style.width = `${progressPercent}%`;
            }
            
            // ç”Ÿæˆé’¢ç´é”®ç›˜
            if (showKeyboard.checked) {
                generateKeyboard();
                keyboardLegend.style.display = 'flex';
            } else {
                keyboardContainer.innerHTML = '';
                keyboardLegend.style.display = 'none';
            }
            
            // ç”ŸæˆéŸ³ç¨‹é€‰é¡¹
            generateIntervalOptions();
            
            // éšè—è§£æå’Œç»“æœé¢æ¿
            noteExplanation.style.display = 'none';
            resultPanel.style.display = 'none';
            exercisePanel.style.display = 'block';
            
            // å¯ç”¨/ç¦ç”¨æŒ‰é’®
            nextBtn.disabled = !state.isAnswered;
        }

        // ç”Ÿæˆé’¢ç´é”®ç›˜ - æ”¹è¿›ç‰ˆï¼Œé»‘é”®ä½äºä¸¤ä¸ªç™½é”®æ­£ä¸­å¤®
        function generateKeyboard() {
            const exercise = state.currentExercise;
            keyboardContainer.innerHTML = '';
            
            // åˆ›å»ºé”®ç›˜å®¹å™¨
            const keyboardWrapper = document.createElement('div');
            keyboardWrapper.className = 'keyboard-container';
            
            // åˆ›å»ºé”®ç›˜
            const keyboard = document.createElement('div');
            keyboard.className = 'keyboard';
            
            // åˆ›å»ºç™½é”®å®¹å™¨
            const whiteKeysContainer = document.createElement('div');
            whiteKeysContainer.className = 'white-keys';
            
            // åˆ›å»ºé»‘é”®å®¹å™¨
            const blackKeysContainer = document.createElement('div');
            blackKeysContainer.className = 'black-keys';
            
            // é’¢ç´é”®ç›˜å¸ƒå±€ï¼šä¸€ä¸ªå…«åº¦ï¼ˆ7ä¸ªç™½é”® + 5ä¸ªé»‘é”®ï¼‰
            const whiteKeyNotes = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
            const blackKeyNotes = [
                { note: 'C#', className: 'c-sharp', position: 1 },
                { note: 'D#', className: 'd-sharp', position: 2 },
                { note: 'F#', className: 'f-sharp', position: 4 },
                { note: 'G#', className: 'g-sharp', position: 5 },
                { note: 'A#', className: 'a-sharp', position: 6 }
            ];
            
            // è·å–èµ·å§‹éŸ³å’Œç›®æ ‡éŸ³çš„ä¿¡æ¯
            const startNoteName = exercise.startNoteObj.keyName;
            const targetNoteName = exercise.targetNoteObj.keyName;
            const isStartBlack = exercise.startNoteObj.blackKey;
            const isTargetBlack = exercise.targetNoteObj.blackKey;
            
            // åˆ›å»ºç™½é”®
            whiteKeyNotes.forEach((note, index) => {
                const whiteKey = document.createElement('div');
                whiteKey.className = 'white-key';
                whiteKey.textContent = note;
                whiteKey.dataset.note = note;
                
                // æ ‡è®°èµ·å§‹éŸ³ï¼ˆç™½é”®ï¼‰
                if (!isStartBlack && startNoteName === note) {
                    whiteKey.classList.add('root');
                }
                
                // æ ‡è®°ç›®æ ‡éŸ³ï¼ˆç™½é”®ï¼‰
                if (!isTargetBlack && targetNoteName === note) {
                    whiteKey.classList.add('interval');
                }
                
                whiteKeysContainer.appendChild(whiteKey);
            });
            
            // åˆ›å»ºé»‘é”®
            blackKeyNotes.forEach((blackKeyInfo, index) => {
                const blackKey = document.createElement('div');
                blackKey.className = `black-key ${blackKeyInfo.className}`;
                blackKey.textContent = blackKeyInfo.note;
                blackKey.dataset.note = blackKeyInfo.note;
                
                // æ ‡è®°èµ·å§‹éŸ³ï¼ˆé»‘é”®ï¼‰
                if (isStartBlack && startNoteName === blackKeyInfo.note) {
                    blackKey.classList.add('root');
                }
                
                // æ ‡è®°ç›®æ ‡éŸ³ï¼ˆé»‘é”®ï¼‰
                if (isTargetBlack && targetNoteName === blackKeyInfo.note) {
                    blackKey.classList.add('interval');
                }
                
                blackKeysContainer.appendChild(blackKey);
            });
            
            // å°†ç™½é”®å’Œé»‘é”®æ·»åŠ åˆ°é”®ç›˜
            keyboard.appendChild(whiteKeysContainer);
            keyboard.appendChild(blackKeysContainer);
            
            // å°†é”®ç›˜æ·»åŠ åˆ°å®¹å™¨
            keyboardWrapper.appendChild(keyboard);
            keyboardContainer.appendChild(keyboardWrapper);
        }

        // ç”ŸæˆéŸ³ç¨‹é€‰é¡¹
        function generateIntervalOptions() {
            const exercise = state.currentExercise;
            intervalOptions.innerHTML = '';
            
            exercise.allAnswers.forEach(answer => {
                const button = document.createElement('button');
                button.className = 'interval-btn';
                button.textContent = answer;
                button.dataset.answer = answer;
                
                // å¦‚æœå·²ç»å›ç­”ï¼Œæ ‡è®°æ­£ç¡®ç­”æ¡ˆå’Œç”¨æˆ·ç­”æ¡ˆ
                if (state.isAnswered) {
                    if (answer === exercise.correctAnswer) {
                        button.classList.add('selected');
                        button.style.backgroundColor = '#2ecc71';
                        button.style.color = 'white';
                    } else if (answer === state.userAnswer && answer !== exercise.correctAnswer) {
                        button.style.backgroundColor = '#e74c3c';
                        button.style.color = 'white';
                    }
                }
                
                button.addEventListener('click', () => selectAnswer(answer));
                
                intervalOptions.appendChild(button);
            });
        }

        // é€‰æ‹©ç­”æ¡ˆ
        function selectAnswer(answer) {
            if (state.isAnswered) return;
            
            state.userAnswer = answer;
            state.isAnswered = true;
            state.stats.total++;
            
            const exercise = state.currentExercise;
            const isCorrect = answer === exercise.correctAnswer;
            
            if (isCorrect) {
                state.stats.correct++;
            }
            
            // æ˜¾ç¤ºè§£æ
            showExplanation(isCorrect);
            
            // æ›´æ–°ç»Ÿè®¡
            updateStats();
            
            // å¯ç”¨ä¸‹ä¸€é¢˜æŒ‰é’®
            nextBtn.disabled = false;
            
            // é‡æ–°ç”Ÿæˆé€‰é¡¹ä»¥æ˜¾ç¤ºæ­£ç¡®/é”™è¯¯çŠ¶æ€
            generateIntervalOptions();
            
            // å¦‚æœå¯ç”¨äº†è‡ªåŠ¨ä¸‹ä¸€é¢˜ï¼Œè®¾ç½®å®šæ—¶å™¨
            if (autoNext.checked && isCorrect) {
                setTimeout(() => {
                    generateExercise();
                }, 1500);
            }
        }

        // æ˜¾ç¤ºè§£æ
        function showExplanation(isCorrect) {
            const exercise = state.currentExercise;
            
            // æ„å»ºè§£ææ–‡æœ¬
            let explanation = `ä» <span class="highlight">${exercise.startNote}</span> åˆ° <span class="highlight">${exercise.targetNote}</span> `;
            explanation += `æ˜¯ <span class="highlight">${exercise.correctAnswer}</span>ã€‚`;
            explanation += `<br><br>è¿™ä¸ªéŸ³ç¨‹åŒ…å« <span class="highlight">${exercise.interval.semitones + Math.abs(exercise.octaveDifference) * 12}</span> ä¸ªåŠéŸ³`;
            
            if (exercise.octaveDifference !== 0) {
                explanation += `ï¼ˆå…¶ä¸­ ${Math.abs(exercise.octaveDifference)} ä¸ªå…«åº¦ï¼Œæ¯ä¸ªå…«åº¦12ä¸ªåŠéŸ³ï¼‰`;
            }
            
            explanation += `ã€‚<br><br>${exercise.interval.description}ã€‚`;
            
            if (!isCorrect) {
                explanation += `<br><br>ä½ é€‰æ‹©çš„æ˜¯ <span class="highlight">${state.userAnswer}</span>ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚`;
            }
            
            // å¦‚æœæ˜¯é¢˜åº“æ¨¡å¼ï¼Œæ˜¾ç¤ºé¢˜ç›®æ¥æº
            if (exercise.fromBank) {
                explanation += `<br><br><small>ï¼ˆæ­¤é¢˜æ¥è‡ªé¢˜åº“ç¬¬${exercise.bankIndex + 1}é¢˜ï¼‰</small>`;
            }
            
            explanationText.innerHTML = explanation;
            noteExplanation.style.display = 'block';
        }

        // æ˜¾ç¤ºç»“æœé¢æ¿
        function showResultPanel(isCorrect) {
            const exercise = state.currentExercise;
            
            // æ›´æ–°ç»“æœé¢æ¿
            if (isCorrect) {
                resultIcon.textContent = 'âœ“';
                resultText.textContent = 'å›ç­”æ­£ç¡®ï¼';
                resultPanel.classList.remove('incorrect');
                resultPanel.classList.add('correct');
            } else {
                resultIcon.textContent = 'âœ—';
                resultText.textContent = 'å›ç­”é”™è¯¯ï¼';
                resultPanel.classList.remove('correct');
                resultPanel.classList.add('incorrect');
            }
            
            resultDetails.textContent = `${exercise.startNote} åˆ° ${exercise.targetNote} æ˜¯ ${exercise.correctAnswer}`;
            
            // æ˜¾ç¤ºç»“æœé¢æ¿ï¼Œéšè—ç»ƒä¹ é¢æ¿
            exercisePanel.style.display = 'none';
            resultPanel.style.display = 'block';
            
            // æ›´æ–°ç»Ÿè®¡
            updateStats();
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            correctCount.textContent = state.stats.correct;
            totalCount.textContent = state.stats.total;
            
            const accuracy = state.stats.total > 0 ? Math.round((state.stats.correct / state.stats.total) * 100) : 0;
            accuracyRate.textContent = `${accuracy}%`;
        }

        // é‡ç½®ç»Ÿè®¡
        function resetStats() {
            state.stats.total = 0;
            state.stats.correct = 0;
            state.currentBankIndex = 0;
            state.questionBankUsed = [];
            
            updateStats();
            
            // é‡ç½®ç•Œé¢
            questionText.textContent = 'ç‚¹å‡»"å¼€å§‹ç»ƒä¹ "æŒ‰é’®å¼€å§‹';
            firstNote.textContent = 'C';
            secondNote.textContent = 'E';
            keyboardContainer.innerHTML = '';
            intervalOptions.innerHTML = '';
            noteExplanation.style.display = 'none';
            resultPanel.style.display = 'none';
            exercisePanel.style.display = 'block';
            nextBtn.disabled = true;
            keyboardLegend.style.display = 'none';
            
            // é‡ç½®è¿›åº¦æ¡
            currentQuestion.textContent = 'ç¬¬1é¢˜';
            progressFill.style.width = '0%';
            totalQuestions.textContent = '/60é¢˜';
        }

        // åˆ‡æ¢é€‰é¡¹å¡
        function switchTab(tabId) {
            // ç§»é™¤æ‰€æœ‰é€‰é¡¹å¡çš„æ´»åŠ¨çŠ¶æ€
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // éšè—æ‰€æœ‰å†…å®¹
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // æ¿€æ´»é€‰ä¸­çš„é€‰é¡¹å¡
            const activeTabBtn = document.querySelector(`[data-tab="${tabId}"]`);
            const activeTabContent = document.getElementById(tabId);
            
            if (activeTabBtn && activeTabContent) {
                activeTabBtn.classList.add('active');
                activeTabContent.classList.add('active');
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            // åˆå§‹åŒ–DOMå…ƒç´ å¼•ç”¨
            intervalTypesContainer = document.getElementById('interval-types');
            startBtn = document.getElementById('startBtn');
            nextBtn = document.getElementById('nextBtn');
            resetBtn = document.getElementById('resetBtn');
            continueBtn = document.getElementById('continueBtn');
            exercisePanel = document.getElementById('exercisePanel');
            resultPanel = document.getElementById('resultPanel');
            questionText = document.getElementById('questionText');
            firstNote = document.getElementById('firstNote');
            secondNote = document.getElementById('secondNote');
            keyboardContainer = document.getElementById('keyboardContainer');
            intervalOptions = document.getElementById('intervalOptions');
            noteExplanation = document.getElementById('noteExplanation');
            explanationText = document.getElementById('explanationText');
            resultIcon = document.getElementById('resultIcon');
            resultText = document.getElementById('resultText');
            resultDetails = document.getElementById('resultDetails');
            correctCount = document.getElementById('correctCount');
            totalCount = document.getElementById('totalCount');
            accuracyRate = document.getElementById('accuracyRate');
            includeDescending = document.getElementById('includeDescending');
            includeCompound = document.getElementById('includeCompound');
            showKeyboard = document.getElementById('showKeyboard');
            autoNext = document.getElementById('autoNext');
            selectAllIntervals = document.getElementById('selectAllIntervals');
            goToPracticeBtn = document.getElementById('goToPractice');
            keyboardLegend = document.getElementById('keyboardLegend');
            practiceModeRandom = document.getElementById('practiceModeRandom');
            practiceModeBank = document.getElementById('practiceModeBank');
            questionProgress = document.getElementById('questionProgress');
            currentQuestion = document.getElementById('currentQuestion');
            progressFill = document.getElementById('progressFill');
            totalQuestions = document.getElementById('totalQuestions');
            arrowText = document.getElementById('arrowText');
            
            // é€‰é¡¹å¡ç›¸å…³å…ƒç´ 
            tabButtons = document.querySelectorAll('.tab-btn');
            tabContents = document.querySelectorAll('.tab-content');
            
            // åˆå§‹åŒ–éŸ³ç¨‹é€‰é¡¹
            initIntervalOptions();
            updateStats();
            
            // äº‹ä»¶ç›‘å¬
            startBtn.addEventListener('click', () => {
                generateExercise();
                nextBtn.disabled = false;
            });

            nextBtn.addEventListener('click', () => {
                generateExercise();
            });

            resetBtn.addEventListener('click', () => {
                if (confirm('ç¡®å®šè¦é‡ç½®ç»Ÿè®¡å—ï¼Ÿ')) {
                    resetStats();
                }
            });

            continueBtn.addEventListener('click', () => {
                generateExercise();
            });

            // å…¨é€‰å¤é€‰æ¡†äº‹ä»¶
            selectAllIntervals.addEventListener('click', handleSelectAllClick);
            
            // ç»ƒä¹ æ¨¡å¼åˆ‡æ¢äº‹ä»¶
            practiceModeRandom.addEventListener('change', handlePracticeModeChange);
            practiceModeBank.addEventListener('change', handlePracticeModeChange);

            // ç›‘å¬è®¾ç½®å˜åŒ–
            showKeyboard.addEventListener('change', () => {
                if (state.currentExercise) {
                    if (showKeyboard.checked) {
                        generateKeyboard();
                        keyboardLegend.style.display = 'flex';
                    } else {
                        keyboardContainer.innerHTML = '';
                        keyboardLegend.style.display = 'none';
                    }
                }
            });
            
            // é€‰é¡¹å¡åˆ‡æ¢äº‹ä»¶
            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // "ç«‹å³å¼€å§‹ç»ƒä¹ "æŒ‰é’®äº‹ä»¶
            goToPracticeBtn.addEventListener('click', (e) => {
                e.preventDefault();
                switchTab('practice');
            });
            
            // åŠ è½½ä¿å­˜çš„ç»Ÿè®¡
            const savedStats = localStorage.getItem('intervalPracticeStats');
            if (savedStats) {
                state.stats = JSON.parse(savedStats);
                updateStats();
            }
            
            // é¡µé¢å¸è½½å‰ä¿å­˜ç»Ÿè®¡
            window.addEventListener('beforeunload', () => {
                localStorage.setItem('intervalPracticeStats', JSON.stringify(state.stats));
            });
        }

        // å¯åŠ¨åº”ç”¨
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
